  procedure FreeMacro(Macro:pMacroRecord;mask:dword=0);

tMacroList = class
  MacroList:pMacroList;
  MacroCount:cardinal;

  // allocate (main) macro list
//  function CreateMacroList(var ML:pMacroList;isize:cardinal):integer;
  constructor Create(isize:cardinal);
  destructor Destroy; override; // FreeMacroList;

  // clone one macro list to other (for editing)
//  function CloneMacroList(srclist:pMacroList;count:integer;var dstlist:pMacroList):integer;
  function Clone(var dstlist:pMacroList):integer;
  // new macro record in custom list
  function NewMacro(var aMacroList:pMacroList;var MaxMacro:cardinal):cardinal;
private
  // clone just assigned values (for editing)
  procedure CloneMacro(var dst,src:pMacroRecord);
  // reallocate custom macro list
  procedure ReallocMacroList(var aMacroList:pMacroList;var MaxMacro:cardinal);
end;

-------------
volatile должны сохраняться в EditMacroList чтоб существовать до конца сессии...
сейчас volatile добавляется в editmacrolist при заполнении списка
ИЛИ при сохранении копироваться
-------------
Сервис - имя сервиса + структура (строка?)
Chain - импорт по имени, сохранение по id - проверить!
-------------
ПОМНИТЬ!!! хранить в списке индекс, т.к. при изменении размера списка адреса поменяются!!!
-------------
редактор структур -= пропадает кнопка хэлпа по переменным
кнопки по результату: (структура - число со знаком)
-------------
блок настроек - например, формат списка контактов
в идеале - ещё настройки макроса, типа тот же поток или нет

т.о. если нет макросов - можно и запретить
если нет экшенов - можно оставить только блок настройки
-------------
кнопка apply не активируется по диалогам
-------------
привести в соответствие ACF_* и ACCF_*
-------------

*+Messagebox
*+start program
+-call service
+import/export clipboard/file
?just text
*+contact
*+-call chain (change to edit macro list)
+-jump action
+read/write settings


chain:
ACF_BYNAME - используется лишь для импорта - оставить в опциях?
FillChainList вызывается каждый раз при изменении списка
(ME_ACT_CHANGED,MS_ACT_GETLIST,MS_ACT_FREELIST)
  переименование
  добавление
  удаление
  релоад
  (импорт)

